(function () {	var settings, dfd;		settings = {		url: "amengine.aspx?config.mn=DDK_Data_Request&data.config=DDK2_Responsive_Template_Favorites_Tools_Query",		dataType: "json",		type: "POST",		// send the global keyword hash		// except sec.* keywords		data: K.toRequestData(),		success: function (data) {			var favorites, toolbars;						favorites = [];						if (data && data.errorMessage) {				DDK.error("DDK tools request error.", data.errorMessage);				return;			}						if (data && data.datasets) {				favorites = data.datasets[0];				favorites = _.toRecordObjects(favorites, { toCase: "camel", prefix: "fav_" });				favorites = _.collateTree(favorites.rows);			}			// register Toolbar Formats			toolbars = _.find(favorites, { name: "PS_TOOLBAR" });			PS.Toolbar.setup(_.favTreeToOptionGroup(toolbars));		}	};		DDK.loadTools = function () {		if (!dfd) {			dfd = $.ajax(settings);		}				return dfd;	};})();